// This is your Prisma schema file
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// æ‹…å½“è€…ãƒ†ãƒ¼ãƒ–ãƒ«
model User {
  id                         Int                         @id @default(autoincrement())
  name                       String
  email                      String
  role                       String                      @default("agent") // "agent", "admin", "manager"ãªã©
  business_card              String? // Base64ç”»åƒãƒ‡ãƒ¼ã‚¿
  agent_tel                  String? // æ‹…å½“è€…ç›´é€šç•ªå·
  agent_email                String? // æ‹…å½“è€…ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
  faxes                      Fax[]
  faxAuditLogs               FaxAuditLog[]
  receivedFaxClassifications ReceivedFaxClassification[]
  autoRoutingRules           AutoRoutingRule[]
}

// ç®¡ç†ä¼šç¤¾ãƒ†ãƒ¼ãƒ–ãƒ«
model Company {
  id               Int            @id @default(autoincrement())
  name             String
  phone            String?
  address          String?
  postal_code      String? // éƒµä¾¿ç•ªå·
  prefecture       String? // éƒ½é“åºœçœŒå
  city             String? // å¸‚åŒºç”ºæ‘
  street           String? // ç•ªåœ°
  building         String? // ãƒ“ãƒ«ãƒ»ãƒãƒ³ã‚·ãƒ§ãƒ³å
  email            String? // ä¼šç¤¾å®›ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
  license_number   String? // ä¸å‹•ç”£å…è¨±ç•ªå·
  fax              String? // FAXç•ªå·
  holiday          String? // å®šä¼‘æ—¥
  transaction_type String? // å–å¼•æ§˜æ…‹ï¼ˆä¾‹: åª’ä»‹ï¼‰
  faxes            Fax[]
  properties       Property[]
  masterCompany    MasterCompany?
}

// ç‰©ä»¶ãƒ†ãƒ¼ãƒ–ãƒ«
model Property {
  id                         Int                         @id @default(autoincrement())
  name                       String
  address                    String
  room_number                String?
  company_id                 Int
  company                    Company                     @relation(fields: [company_id], references: [id])
  faxes                      Fax[]
  receivedFaxClassifications ReceivedFaxClassification[]
}

// é€ä¿¡å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«
model Fax {
  id             Int       @id @default(autoincrement())
  property_id    Int
  company_id     Int
  user_id        Int
  fax_number     String
  sent_at        DateTime
  status         String // "success", "failed", "pending"
  purpose        String? // é€ä¿¡ç›®çš„ï¼ˆ"visit_request", "application", "additional_documents", "other", "business_card"ï¼‰
  unlock_method  String? // é›»è©±ã§ç¢ºèªã—ãŸè§£éŒ æ–¹æ³•
  notes          String? // æ³¨æ„äº‹é …ãƒ¡ãƒ¢
  image_url      String? // Base64ç”»åƒãƒ‡ãƒ¼ã‚¿ï¼ˆãƒã‚¤ã‚½ã‚¯å›³é¢ï¼‰
  visit_date     String? // å†…è¦‹äºˆç´„æ—¥
  visit_time     String? // å†…è¦‹äºˆç´„æ™‚é–“
  company_phone  String? // ç®¡ç†ä¼šç¤¾é›»è©±ç•ªå·
  template_id    Int? // ä½¿ç”¨ã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆID
  scheduled_at   DateTime? // äºˆç´„é€ä¿¡æ—¥æ™‚
  retry_enabled  Boolean   @default(false) // è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤æœ‰åŠ¹
  retry_count    Int       @default(0) // ãƒªãƒˆãƒ©ã‚¤å›æ•°
  retry_max      Int       @default(3) // æœ€å¤§ãƒªãƒˆãƒ©ã‚¤å›æ•°
  retry_interval Int       @default(60) // ãƒªãƒˆãƒ©ã‚¤é–“éš”ï¼ˆç§’ï¼‰
  is_read        Boolean   @default(false) // æœªèª­ãƒ•ãƒ©ã‚°ï¼ˆé€ä¿¡å±¥æ­´ã§ã¯ä½¿ç”¨ã—ãªã„ãŒäº’æ›æ€§ã®ãŸã‚ä¿æŒï¼‰
  created_at     DateTime  @default(now())
  updated_at     DateTime  @updatedAt

  user      User          @relation(fields: [user_id], references: [id])
  property  Property      @relation(fields: [property_id], references: [id])
  company   Company       @relation(fields: [company_id], references: [id])
  template  FaxTemplate?  @relation(fields: [template_id], references: [id])
  auditLogs FaxAuditLog[]
}

// å—ä¿¡FAXãƒ†ãƒ¼ãƒ–ãƒ«
model ReceivedFax {
  id                 Int      @id @default(autoincrement())
  from_fax_number    String // é€ä¿¡å…ƒFAXç•ªå·
  from_company_name  String? // é€ä¿¡å…ƒä¼šç¤¾åï¼ˆOCRã§æŠ½å‡ºï¼‰
  received_at        DateTime @default(now()) // å—ä¿¡æ—¥æ™‚
  image_url          String? // å—ä¿¡FAXç”»åƒï¼ˆBase64ç”»åƒãƒ‡ãƒ¼ã‚¿ï¼‰
  ocr_text           String? // OCRã§æŠ½å‡ºã—ãŸãƒ†ã‚­ã‚¹ãƒˆ
  ai_summary         String? // AIè¦ç´„
  is_read            Boolean  @default(false) // æœªèª­ãƒ•ãƒ©ã‚°
  property_name      String? // ç‰©ä»¶åï¼ˆOCRã§æŠ½å‡ºï¼‰
  room_number        String? // å·å®¤ï¼ˆOCRã§æŠ½å‡ºï¼‰
  notes              String? // å‚™è€ƒãƒ»ãƒ¡ãƒ¢
  document_type      String? // æ›¸é¡ç¨®åˆ¥ï¼ˆAIæ¨æ¸¬: "å†…è¦‹ç”³è«‹", "ç”³è¾¼æ›¸", "å¥‘ç´„æ›¸", "ãã®ä»–"ãªã©ï¼‰
  urgency            String? // ç·Šæ€¥åº¦ï¼ˆAIæ¨æ¸¬: "high", "medium", "low"ï¼‰
  context_prediction String? // æ–‡è„ˆæ¨æ¸¬çµæœï¼ˆJSONå½¢å¼ã§ä¿å­˜ï¼‰
  next_actions       String? // ãƒã‚¯ã‚¹ãƒˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆJSONå½¢å¼ã§ä¿å­˜ï¼‰
  status             String?  @default("received") // "received", "processing", "processed", "error"
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt

  classification ReceivedFaxClassification?
  tags           ReceivedFaxTag[]
  printJobs      PrintJob[]
}

// FAXé€ä¿¡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«
model FaxTemplate {
  id         Int      @id @default(autoincrement())
  name       String // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåï¼ˆä¾‹: "å†…è¦‹ç”³è«‹"ï¼‰
  category   String // ã‚«ãƒ†ã‚´ãƒªï¼ˆä¾‹: "å†…è¦‹ç”³è«‹", "ç”³è¾¼æ›¸é€ä»˜", "ä¸è¶³æ›¸é¡é€ä»˜", "æ¡ˆå†…å ±å‘Š"ï¼‰
  content    String // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæœ¬æ–‡
  is_default Boolean  @default(false) // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  faxes                       Fax[]
  realEstateDocumentTemplates RealEstateDocumentTemplate[]
}

// ã‚·ã‚¹ãƒ†ãƒ è¨­å®šãƒ»è‡ªç¤¾æƒ…å ±ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³æƒ³å®šï¼‰
model Settings {
  id                     Int     @id @default(autoincrement())
  company_name           String?
  company_address        String?
  company_phone          String?
  company_fax            String?
  obi_image              String? // å¸¯ç”»åƒï¼ˆBase64ç”»åƒãƒ‡ãƒ¼ã‚¿ï¼‰
  business_card_template String? // ååˆºãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆHTMLï¼‰
  business_card_image    String? // ååˆºç”»åƒï¼ˆBase64ç”»åƒãƒ‡ãƒ¼ã‚¿ã€æ—¢å­˜ãƒ‡ã‚¶ã‚¤ãƒ³ãŒã‚ã‚‹å ´åˆï¼‰

  fax_success_notify Boolean @default(true)
  fax_failure_notify Boolean @default(true)

  timezone   String @default("Asia/Tokyo")
  language   String @default("ja")
  pdf_format String @default("A4")
}

// åˆ©ç”¨æ˜ç´°ãƒ†ãƒ¼ãƒ–ãƒ«
model UsageStatement {
  id             Int      @id @default(autoincrement())
  usage_month    String // åˆ©ç”¨å¹´æœˆï¼ˆYYYY-MMå½¢å¼ï¼‰
  sent_count     Int      @default(0) // é€ä¿¡æšæ•°
  received_count Int      @default(0) // å—ä¿¡æšæ•°
  base_fee       Int      @default(0) // åŸºæœ¬æ–™é‡‘ï¼ˆå††ï¼‰
  usage_fee      Int      @default(0) // åˆ©ç”¨æ–™ï¼ˆå††ï¼‰
  tax_amount     Int      @default(0) // ç¨é¡ï¼ˆå††ï¼‰
  total_amount   Int      @default(0) // è«‹æ±‚é‡‘é¡ï¼ˆå††ï¼‰
  receipt_pdf    String? // é ˜åæ›¸PDFï¼ˆBase64ã¾ãŸã¯URLï¼‰
  payment_pdf    String? // æ”¯æ‰•æ˜ç´°PDFï¼ˆBase64ã¾ãŸã¯URLï¼‰
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt
}

// åˆ©ç”¨æšæ•°ã‚«ã‚¦ãƒ³ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆç„¡æœŸé™ä¿æŒã€å±¥æ­´å‰Šé™¤ã®å½±éŸ¿ã‚’å—ã‘ãªã„ï¼‰
model UsageCount {
  id             Int      @id @default(autoincrement())
  usage_year     Int      // åˆ©ç”¨å¹´ï¼ˆYYYYå½¢å¼ï¼‰
  usage_month    Int      // åˆ©ç”¨æœˆï¼ˆ1-12ï¼‰
  sent_count     Int      @default(0) // é€ä¿¡æšæ•°
  received_count Int      @default(0) // å—ä¿¡æšæ•°
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt

  @@unique([usage_year, usage_month])
  @@index([usage_year, usage_month])
}

// ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æƒ…å ±ãƒ†ãƒ¼ãƒ–ãƒ«
model CreditCard {
  id                Int      @id @default(autoincrement())
  card_number_last4 String? // ã‚«ãƒ¼ãƒ‰ç•ªå·ä¸‹4æ¡
  card_brand        String? // ã‚«ãƒ¼ãƒ‰ãƒ–ãƒ©ãƒ³ãƒ‰ï¼ˆVisa, MasterCardç­‰ï¼‰
  expiry_month      String? // æœ‰åŠ¹æœŸé™ï¼ˆæœˆï¼‰
  expiry_year       String? // æœ‰åŠ¹æœŸé™ï¼ˆå¹´ï¼‰
  cardholder_name   String? // ã‚«ãƒ¼ãƒ‰åç¾©äºº
  is_default        Boolean  @default(true) // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚«ãƒ¼ãƒ‰
  created_at        DateTime @default(now())
  updated_at        DateTime @updatedAt
}

// ============================================
// ğŸ†• ä¸å‹•ç”£æ¥­ç•Œç‰¹åŒ–æ©Ÿèƒ½ - æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«
// ============================================

// ğŸ†• ä¸å‹•ç”£æ›¸é¡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆæ—¢å­˜FaxTemplateã‚’æ‹¡å¼µã™ã‚‹ä»£ã‚ã‚Šã«ã€ç‰¹åŒ–ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’åˆ¥ç®¡ç†ï¼‰
model RealEstateDocumentTemplate {
  id            Int      @id @default(autoincrement())
  name          String
  category      String // "ç”³è¾¼æ›¸", "å¥‘ç´„æ›¸", "å†…è¦‹ç”³è«‹", "ä¿®ç¹•ä¾é ¼", "ç‰©ä»¶ç¢ºèª", "å¯©æŸ»çµæœ"ãªã©
  template_type String // "form", "letter", "report", "contract"
  content       String // HTML/JSONå½¢å¼ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  variables     String? // JSONå½¢å¼ã®å¤‰æ•°å®šç¾©ï¼ˆä¾‹: {"property_name": "ç‰©ä»¶å", "room_number": "å·å®¤"}ï¼‰
  preview_image String? // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒï¼ˆBase64ï¼‰
  is_active     Boolean  @default(true)
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt

  // æ—¢å­˜FaxTemplateã¨ã®é–¢é€£ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  base_template_id Int?
  base_template    FaxTemplate? @relation(fields: [base_template_id], references: [id])
}

// ğŸ†• ç®¡ç†ä¼šç¤¾ãƒã‚¹ã‚¿ï¼ˆæ—¢å­˜Companyãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ‹¡å¼µã™ã‚‹ä»£ã‚ã‚Šã«ã€ç‰¹åŒ–æƒ…å ±ã‚’åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã§ç®¡ç†ï¼‰
model MasterCompany {
  id                   Int      @id @default(autoincrement())
  company_id           Int      @unique // Companyãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®å‚ç…§
  company              Company  @relation(fields: [company_id], references: [id])
  preferred_fax_number String? // å„ªå…ˆFAXç•ªå·
  business_hours       String? // å–¶æ¥­æ™‚é–“ï¼ˆJSONå½¢å¼: {"weekdays": "9:00-18:00", "weekends": "10:00-17:00"}ï¼‰
  contact_person       String? // æ‹…å½“è€…å
  department           String? // éƒ¨ç½²å
  notes                String? // å‚™è€ƒ
  tags                 String? // JSONå½¢å¼ã®ã‚¿ã‚°ï¼ˆä¾‹: ["é‡è¦", "è‡ªå‹•è¿”ä¿¡å¯¾å¿œ"]ï¼‰
  auto_reply_enabled   Boolean  @default(false) // è‡ªå‹•è¿”ä¿¡æœ‰åŠ¹åŒ–
  created_at           DateTime @default(now())
  updated_at           DateTime @updatedAt
}

// ğŸ†• ã‚¢ãƒ‰ãƒ¬ã‚¹å¸³ãƒ†ãƒ¼ãƒ–ãƒ«
model AddressBook {
  id             Int      @id @default(autoincrement())
  name           String // ä¼šç¤¾åãƒ»çµ„ç¹”å
  fax_number     String // FAXç•ªå·
  phone          String? // é›»è©±ç•ªå·
  email          String? // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
  address        String? // ä½æ‰€
  contact_person String? // æ‹…å½“è€…å
  notes          String? // å‚™è€ƒ
  tags           String? // JSONå½¢å¼ã®ã‚¿ã‚°ï¼ˆä¾‹: ["é‡è¦", "é »ç¹ã«ä½¿ç”¨"]ï¼‰
  is_favorite    Boolean  @default(false) // ãŠæ°—ã«å…¥ã‚Šãƒ•ãƒ©ã‚°
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt
}

// ğŸ†• ååˆºãƒ†ãƒ¼ãƒ–ãƒ«
model BusinessCard {
  id             Int      @id @default(autoincrement())
  name           String // æ‹…å½“è€…å
  email          String? // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
  phone          String? // é›»è©±ç•ªå·
  position       String? // å½¹è·
  department     String? // éƒ¨ç½²
  image          String? // Base64ç”»åƒãƒ‡ãƒ¼ã‚¿
  template_html  String? // HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆååˆºç”Ÿæˆç”¨ï¼‰
  variables      String? // JSONå½¢å¼ã®å¤‰æ•°ï¼ˆååˆºç”Ÿæˆæ™‚ã®å¤‰æ•°ï¼‰
  notes          String? // å‚™è€ƒ
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt
}

// ğŸ†• é€ä¿¡ãƒ­ã‚°ãƒ»è¨¼è·¡ï¼ˆæ—¢å­˜Faxãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ‹¡å¼µï¼‰
model FaxAuditLog {
  id            Int      @id @default(autoincrement())
  fax_id        Int
  fax           Fax      @relation(fields: [fax_id], references: [id])
  action        String // "sent", "failed", "retried", "cancelled", "scheduled", "rescheduled"
  status        String // "success", "failed", "pending", "cancelled"
  error_message String?
  metadata      String? // JSONå½¢å¼ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆé€ä¿¡å…ˆã€é€ä¿¡æ™‚åˆ»ã€å†é€å›æ•°ãªã©ï¼‰
  ip_address    String? // é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆç›£æŸ»ç”¨ï¼‰
  user_id       Int? // é€ä¿¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
  user          User?    @relation(fields: [user_id], references: [id])
  created_at    DateTime @default(now())

  @@index([fax_id])
  @@index([created_at])
  @@index([action])
}

// ğŸ†• å—ä¿¡FAXåˆ†é¡çµæœï¼ˆæ—¢å­˜ReceivedFaxãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ‹¡å¼µï¼‰
model ReceivedFaxClassification {
  id                Int         @id @default(autoincrement())
  received_fax_id   Int         @unique
  received_fax      ReceivedFax @relation(fields: [received_fax_id], references: [id])
  document_type     String // "ç”³è¾¼æ›¸", "ç‰©ä»¶ç¢ºèª", "ä¿®ç¹•ä¾é ¼", "å¯©æŸ»çµæœ", "å¥‘ç´„æ›¸", "ãã®ä»–"ãªã©
  confidence        Float // åˆ†é¡ã®ä¿¡é ¼åº¦ (0-1)
  extracted_fields  String? // JSONå½¢å¼ã®æŠ½å‡ºé …ç›®ï¼ˆä¾‹: {"contract_date": "2024-01-15", "rent": "80000"}ï¼‰
  property_match_id Int? // ç´ã¥ã‘ã‚‰ã‚ŒãŸç‰©ä»¶ID
  property          Property?   @relation(fields: [property_match_id], references: [id])
  assigned_user_id  Int? // æŒ¯ã‚Šåˆ†ã‘ã‚‰ã‚ŒãŸæ‹…å½“è€…ID
  assigned_user     User?       @relation(fields: [assigned_user_id], references: [id])
  routing_rule_id   Int? // ä½¿ç”¨ã—ãŸæŒ¯ã‚Šåˆ†ã‘ãƒ«ãƒ¼ãƒ«ID
  created_at        DateTime    @default(now())
  updated_at        DateTime    @updatedAt

  @@index([document_type])
  @@index([property_match_id])
  @@index([assigned_user_id])
}

// ğŸ†• å—ä¿¡FAXã‚¿ã‚°
model ReceivedFaxTag {
  id              Int         @id @default(autoincrement())
  received_fax_id Int
  received_fax    ReceivedFax @relation(fields: [received_fax_id], references: [id])
  tag             String
  created_at      DateTime    @default(now())

  @@unique([received_fax_id, tag])
  @@index([tag])
}

// ğŸ†• è‡ªå‹•è¿”ä¿¡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
model AutoReplyTemplate {
  id                 Int      @id @default(autoincrement())
  trigger_type       String // "ç‰©ä»¶ç¢ºèª", "ä¿®ç¹•ä¾é ¼", "ç”³è¾¼æ›¸å—é ˜"ãªã©
  trigger_keywords   String? // JSONå½¢å¼ã®ãƒˆãƒªã‚¬ãƒ¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆä¾‹: ["ç‰©ä»¶ç¢ºèª", "ç‰©ä»¶ã«ã¤ã„ã¦"]ï¼‰
  template_content   String
  template_variables String? // JSONå½¢å¼ã®å¤‰æ•°å®šç¾©
  is_active          Boolean  @default(true)
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt
}

// ğŸ†• è‡ªå‹•æŒ¯ã‚Šåˆ†ã‘ãƒ«ãƒ¼ãƒ«
model AutoRoutingRule {
  id                Int      @id @default(autoincrement())
  name              String
  priority          Int      @default(0) // å„ªå…ˆåº¦ï¼ˆé«˜ã„ã»ã©å„ªå…ˆï¼‰
  conditions        String // JSONå½¢å¼ã®æ¡ä»¶ï¼ˆä¾‹: {"document_type": "ç”³è¾¼æ›¸", "urgency": "high"}ï¼‰
  target_user_id    Int? // æŒ¯ã‚Šåˆ†ã‘å…ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ID
  target_user       User?    @relation(fields: [target_user_id], references: [id])
  target_department String? // æŒ¯ã‚Šåˆ†ã‘å…ˆéƒ¨ç½²å
  is_active         Boolean  @default(true)
  created_at        DateTime @default(now())
  updated_at        DateTime @updatedAt

  @@index([priority])
}

// ğŸ†• åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ é€£æºè¨­å®š
model SystemIntegration {
  id           Int       @id @default(autoincrement())
  system_name  String // "ç‰©ä»¶ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ", "é¡§å®¢ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ", "ä¼šè¨ˆã‚·ã‚¹ãƒ†ãƒ "ãªã©
  system_type  String // "property_management", "crm", "accounting", "custom"
  api_endpoint String
  api_key      String? // æš—å·åŒ–ã—ã¦ä¿å­˜ï¼ˆç’°å¢ƒå¤‰æ•°ã¾ãŸã¯æš—å·åŒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ç”¨ï¼‰
  api_secret   String? // æš—å·åŒ–ã—ã¦ä¿å­˜
  config       String? // JSONå½¢å¼ã®è¨­å®šï¼ˆèªè¨¼æ–¹å¼ã€åŒæœŸé–“éš”ãªã©ï¼‰
  is_active    Boolean   @default(true)
  last_sync_at DateTime? // æœ€çµ‚åŒæœŸæ™‚åˆ»
  created_at   DateTime  @default(now())
  updated_at   DateTime  @updatedAt

  @@unique([system_name])
}

// ğŸ†• å°åˆ·ã‚¸ãƒ§ãƒ–
model PrintJob {
  id              Int          @id @default(autoincrement())
  received_fax_id Int?
  received_fax    ReceivedFax? @relation(fields: [received_fax_id], references: [id])
  document_type   String // "å›³é¢", "è³‡æ–™", "å¥‘ç´„æ›¸"ãªã©
  printer_name    String? // ãƒ—ãƒªãƒ³ã‚¿ãƒ¼å
  status          String       @default("pending") // "pending", "printing", "completed", "failed"
  error_message   String?
  created_at      DateTime     @default(now())
  completed_at    DateTime?

  @@index([status])
  @@index([received_fax_id])
}
